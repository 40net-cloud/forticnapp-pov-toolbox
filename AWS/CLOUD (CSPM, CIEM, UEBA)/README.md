

### üß± FortiCNAPP Terraform Deployment Options

| **Deployment Method** | **Description** | **Supported Capabilities** |
|------------------------|-----------------|-----------------------------|
| ‚ö° **Automated Configuration** | Deploy FortiCNAPP using a **prebuilt Terraform automation flow** that provisions all required resources automatically in a **single AWS region**.<br><br>üîë *Note:* Requires **temporary credentials** (AWS Access Key ID & Secret Access Key) for your AWS account. | ‚úÖ&nbsp;Single&nbsp;AWS&nbsp;Account <br>‚úÖ&nbsp;Cloud&nbsp;Config&nbsp;&amp;&nbsp;Audit&nbsp;Logs <br>‚úÖ&nbsp;Agentless&nbsp;Workload&nbsp;Scanning |
| <br> | <br> | <br> |
| üß≠ **Terraform via Guided Configuration (UI)** | Deploy and manage FortiCNAPP integrations through the **FortiCNAPP Web Console**.<br><br>Provides a **wizard-based experience** for onboarding and connecting AWS environments without direct CLI interaction. | ‚úÖ&nbsp;Single&nbsp;&amp;&nbsp;Multiple&nbsp;AWS&nbsp;Accounts <br>‚úÖ&nbsp;Cloud&nbsp;Config&nbsp;&amp;&nbsp;Audit&nbsp;Logs <br>‚úÖ&nbsp;EKS&nbsp;Audit&nbsp;Logs |
| <br> | <br> | <br> |
| ‚öôÔ∏è **Terraform via FortiCNAPP CLI** | Command-line‚Äìdriven automation using the **open-source FortiCNAPP CLI** (written in Go).<br><br>Ideal for **organization-wide**, **multi-account**, or **DevOps-integrated** deployments. | ‚úÖ&nbsp;AWS&nbsp;Organization-level&nbsp;Access <br>‚úÖ&nbsp;Single&nbsp;&amp;&nbsp;Multiple&nbsp;AWS&nbsp;Accounts <br>‚úÖ&nbsp;Cloud&nbsp;Config&nbsp;&amp;&nbsp;Audit&nbsp;Logs <br>‚úÖ&nbsp;EKS&nbsp;Audit&nbsp;Logs <br>‚úÖ&nbsp;Agentless&nbsp;Workload&nbsp;Scanning |





### ‚òÅÔ∏è AWS & FortiCNAPP Terraform Prerequisites

| **Component / Requirement** | **Description** | **Reference / Link** |
|------------------------------|-----------------|----------------------|
| üßë‚Äçüíª **AWS Account Admin** | Administrative privileges on each AWS account.<br>Required during onboarding process only. | ‚Äî |
| üîß **AWS CLI** | Install and configure the AWS CLI to connect to your AWS Account. | [AWS CLI Installation Guide](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html) |
| üß∞ **Linux Tools** | Ensure basic tools (`curl`, `git`, `unzip`) are available in the system `PATH`. | ‚Äî |
| ‚öôÔ∏è **Terraform** | Install Terraform if not already configured. | [Terraform Documentation](https://developer.hashicorp.com/terraform) |
| üß† **FortiCNAPP CLI** | Open-source CLI tool written in Golang. Available for **Linux**, **macOS**, and **Windows**.<br>Used to interact with FortiCNAPP via command line. | [FortiCNAPP CLI Guide](https://docs.fortinet.com/document/forticnapp/latest/cli-reference/68020/get-started-with-the-lacework-forticnapp-cli) |
| ‚ö° **Deployment Methods** | Supported installation environments and automation options:<br>‚Ä¢ **AWS Cloud Shell**<br>‚Ä¢ **Hosts Supported by Terraform** | ‚Äî |



### ‚òÅÔ∏è AWS Prerequisites for FortiCNAPP Integration

| **Component** | **Description** | **FortiCNAPP Usage / Notes** |
|----------------|-----------------|-------------------------------|
| üì® **SNS Topic** | An **Amazon Simple Notification Service (SNS)** topic is a logical access point that acts as a communication channel, grouping multiple endpoints such as AWS, Amazon SQS, HTTP/S, or email addresses. | Required for **all CloudTrail integrations**.<br>FortiCNAPP can use an **existing SNS topic** or create one automatically if not present. |
| üì¨ **SQS Queue** | **Amazon Simple Queue Service (SQS)** enables distributed applications to exchange messages asynchronously. SNS and SQS together deliver notifications immediately while persisting messages for later processing. | Required for **all CloudTrail integrations**.<br>Used alongside SNS to deliver CloudTrail events to FortiCNAPP. |
| üóÉÔ∏è **S3 Bucket** | An **Amazon S3 bucket** is a container for objects. CloudTrail stores log files in S3 buckets. | Required for **all CloudTrail integrations**.<br>FortiCNAPP can use an existing S3 bucket or create one in the designated AWS account. |
| ‚òÅÔ∏è **CloudTrail** | **AWS CloudTrail** records user, role, or service actions across your AWS account for governance, compliance, and audit purposes. | Required to capture and deliver event logs to FortiCNAPP.<br>FortiCNAPP can use an **existing CloudTrail** or create a new one. |
| üîê **IAM Cross-Account Role** | An **IAM cross-account role** grants FortiCNAPP access to AWS resources for configuration assessment and CloudTrail event analysis. | Required for **read-only access**.<br>Includes two policies:<br>‚Ä¢ **FortiCNAPP custom audit policy** ‚Äì read-only access to configuration resources.<br>‚Ä¢ **FortiCNAPP custom IAM policy** ‚Äì read-only access to ingest CloudTrail logs. |
| ‚ö†Ô∏è **Important Note** | Ensure your **IAM cross-account role** and **S3 bucket** are created in the **same AWS account** ‚Äî regardless of setup method (manual, CloudFormation, or Terraform). | This is due to **legacy AWS access control rules**. Cross-account access alone is **not sufficient** to bypass these S3 restrictions. |

---

> üí° **Architecture Summary:**  
> These AWS components work together to securely deliver CloudTrail audit data and configuration information to **FortiCNAPP**, enabling continuous compliance, visibility, and threat detection across your cloud environment.
